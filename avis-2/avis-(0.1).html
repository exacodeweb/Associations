<!--
<?php
session_start();
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}
?>-->
<script></script>
session_start();

// Vérification du démarrage de la session
if (session_status() == PHP_SESSION_ACTIVE) {
    echo "Session démarrée avec succès.<br>";
} else {
    echo "Erreur : La session n'a pas pu être démarrée.<br>";
}

// Génération du token CSRF si nécessaire
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}
?>





<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Entomologie">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../style/avis_style.css">
  <title>ECF-Contact</title>



  <input type="hidden" name="csrf_token" value="<?php echo $_SESSION['csrf_token']; ?>">

</head>
<body>
  <!-- Breadcrumb navigation -->
  <div class="breadcrumb-item"> 
    <a href="../pages/sommaire.html" class="link-item">Sommaire</a> >
    <a href="../index.html" class="link-item">Accueil</a> > Avis
  </div>
  <div class="content"><!--container mt-5-->
    <main class="main">
      <div class="section-form">
        <div class="article">
          <h2 class="title">Laisser un Avis</h2>
          <p class="text-center">
            Nous serions ravis de recevoir vos questions, suggestions ou commentaires.
            Il vous suffit de remplir ce formulaire et de le valider. Un e-mail de confirmation vous sera envoyé.
            Merci de prendre le temps de nous contacter. Nous vous répondrons dans les plus brefs délais !
          </p>
        </div>
        <?php
        <!--// Démarre la session et génère un token CSRF si nécessaire
        session_start();
        if (empty($_SESSION['csrf_token'])) {
            $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
        }
        ?>-->

        <?php
        // Démarre la session et génère un token CSRF si nécessaire
        session_start();
        if (empty($_SESSION['csrf_token'])) {
            $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
        }
        // Affichage du token CSRF pour le débogage
        echo "<p>Token CSRF dans le formulaire : " . $_SESSION['csrf_token'] . "</p>";
        ?>

        <!-- Formulaire pour soumettre un avis -->
        <form class="form" id="contact-form" action="../php/submit_avis.php" method="post">
          <!-- Champ caché pour le token CSRF -->
          <input type="hidden" name="csrf_token" value="<?php echo $_SESSION['csrf_token']; ?>">
          <div class="form-group">
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" class="form-control" placeholder="Votre nom" required>
          </div>
          <div class="form-group">
            <label for="email">Email :</label>
            <input type="email" id="email" name="email" class="form-control" placeholder="Votre adresse e-mail" required>
          </div>
          <div class="form-group">
            <label for="message">Message :</label>
            <textarea id="message" name="message" class="form-control" rows="4" placeholder="Votre message" required></textarea>
          </div>
          <div class="form-group">
            <label for="note">Note :</label>
            <input type="number" id="note" name="note" class="form-control" placeholder="Votre note (1-5)" min="1" max="5">
          </div>
          <button type="submit" class="btn btn-primary">Envoyer</button>
        </form>
      </div>
    </main>
  </div>
</body>
</html>





<!--------------------------------------------------------------------------------------------------------------------->
<?php
include 'path/to/session_init.php'; // Assurez-vous de remplacer 'path/to/' par le chemin correct vers session_init.php
?>

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Entomologie">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../style/avis_style.css">
  <title>ECF-Contact</title>
</head>
<body>
  <div class="breadcrumb-item"> 
    <a href="../pages/sommaire.html" class="link-item">Sommaire</a> >
    <a href="../index.html" class="link-item">Accueil</a> > Avis
  </div>
  <div class="container mt-5">
    <main class="main">
      <div class="section-form">
        <div class="article">
          <h2 class="title">Laisser un Avis</h2>
          <p class="text-center">
            Nous serions ravis de recevoir vos questions, suggestions ou commentaires.
            Il vous suffit de remplir ce formulaire et de le valider. Un e-mail de confirmation vous sera envoyé.
            Merci de prendre le temps de nous contacter. Nous vous répondrons dans les plus brefs délais !
          </p>
        </div>
        <!-- Affichage du token CSRF pour le débogage -->
        <p>Token CSRF dans le formulaire : <?php echo $_SESSION['csrf_token']; ?></p>
        <form class="form" id="contact-form" action="submit_avis.php" method="post" onsubmit="return validateForm()">
          <input type="hidden" name="csrf_token" value="<?php echo $_SESSION['csrf_token']; ?>">
          <div class="form-group">
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" class="form-control" placeholder="Votre nom" required>
          </div>
          <div class="form-group">
            <label for="email">Email :</label>
            <input type="email" id="email" name="email" class="form-control" placeholder="Votre adresse e-mail" required>
          </div>
          <div class="form-group">
            <label for="message">Message :</label>
            <textarea id="message" name="message" class="form-control" rows="4" placeholder="Votre message" required></textarea>
          </div>
          <div class="form-group">
            <label for="note">Note :</label>
            <input type="number" id="note" name="note" class="form-control" placeholder="Votre note (1-5)" min="1" max="5">
          </div>
          <button type="submit" class="btn btn-primary">Envoyer</button>
        </form>
      </div>
    </main>
  </div>
  <script>
    function validateForm() {
      var name = document.getElementById("name").value;
      var email = document.getElementById("email").value;
      var message = document.getElementById("message").value;
      var note = document.getElementById("note").value;

      if (name == "" || email == "" || message == "") {
        alert("Tous les champs sont requis.");
        return false;
      }

      if (note != "" && (note < 1 || note > 5)) {
        alert("La note doit être entre 1 et 5.");
        return false;
      }

      return true;
    }
  </script>
</body>
</html>

